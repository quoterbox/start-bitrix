function ajaxForms(){this.init()}function ajaxRequest(){this.init()}$(function(){new ajaxForms}),$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},ajaxForms.prototype={type:"",action_url:"/ajax.php",default_type:"default",container:null,container_class:"page_wrapper",form:null,form_class:"simple_form",modal:null,modal_params:{modal_window_class:"modal_window",open_class:"show_modal",default_title:"Информация",fixed:!0,blockScroll:!0,closeButtonType:"box",position:{},success_width:"auto",success_title:""},afterCloseModal:function(){},current_name:"",current_text:"",current_val:"",error_block:'<div class="error"><div class="errortext"></div></div>',init:function(){this.container=$("."+this.container_class),this.hideFormErrors(),this.submitForm(),this.openModal(),this.loadPlugins()},hideFormErrors:function(){$("body").on("focus","input:not(input[type=submit], input[type=button]), textarea, select",function(){$(this).hasClass("error_input")&&($(this).removeClass("error_input"),$(this).closest(".wrap_input").length&&$(this).closest(".wrap_input").find(".error").fadeOut(300,function(){$(this).remove()}))}),$("body").on("change","select",function(){$(this).parent().find(".jq-selectbox__select").removeClass("error_input")})},loadPlugins:function(){$("input.phone").mask("+7 (999) 999-99-99"),$("input.date").mask("99.99.9999"),$("input[name=passport]").mask("Серия 9999 №999999"),$(".styler").styler({singleSelectzIndex:50})},submitForm:function(){var t=this;t.container.on("submit","."+t.form_class,function(e){e.preventDefault(),t.type=$(this).data("action"),t.form=$(this),t.sendData()})},sendData:function(){var t=this;$.ajax({url:t.action_url,type:"POST",dataType:"json",data:{type:t.type,data:t.form.serializeObject()}}).done(function(e){e.errors?(t.form.find("input.error_input, select.error_input, textarea.error_input").removeClass("error_input").closest(".wrap_input").find(".error").fadeOut(300,function(){$(this).remove()}),$.each(e.errors,function(e,i){t.form.find("[name="+e+"]").addClass("error_input");var n=t.form.find("[name="+e+"]").closest(".wrap_input").append(t.error_block),o=n.find(".error");o.find(".errortext").text(i),o.fadeIn(300)})):t.successChanges(e.SUCCESS_TYPE,e.SUCCESS_TITLE,e.MORE_PARAM)})},openModal:function(){var t=this;t.container.on("click","."+t.modal_params.open_class,function(){t.type=$(this).data("modal__type");var e=$(this).data("modal__more_params"),i=$(this).data("modal__title");t.showModal(i,e)})},showModal:function(t,e){var i=this,n={},o=i.modal_params.fixed,s=i.modal_params.blockScroll,a=i.modal_params.position;i.afterCloseModal=function(){},i.type||(i.type=i.default_type),t||(t=i.modal_params.default_title),e&&"order_form_success"===i.type&&(n.more_param=e),i.type.indexOf("_success")+1&&i.modal_params.success_width&&(t=i.modal_params.success_title),i.modal=new jBox("Modal",{addClass:i.modal_params.modal_window_class+" "+i.type,title:t,closeButton:i.modal_params.closeButtonType,fixed:o,blockScroll:s,position:a,reposition:!0,maxWidth:"100%",adjustDistance:{top:20,right:0,bottom:20,left:0},ajax:{url:i.action_url,data:{type:i.type,data:n},type:"POST",reload:!0,setContent:!0,spinner:!0,spinnerReposition:!1,complete:function(){i.form=$("."+i.modal_params.modal_window_class+"."+i.type).find("."+i.form_class),i.form.length&&i.submitModalForm(),i.modal.position(),i.loadPlugins()}},onCloseComplete:function(){i.afterCloseModal(),i.modal.destroy(),i.modal=null}}).open()},submitModalForm:function(){var t=this;t.form.submit(function(e){e.preventDefault(),t.type=$(this).data("action"),t.sendData()})},showModalSuccess:function(t,e){var i=this;if(i.modal){if(t)var n=t;else var n="";i.modal_params.modal_window_class&&$("."+i.modal_params.modal_window_class).addClass("success"),i.modal.setTitle(n).ajax({url:i.action_url,data:{type:i.type,data:{more_param:e}},type:"POST",reload:!0,getData:"data-ajax",setContent:!0,spinner:!0,complete:function(){i.modal_params.success_width&&i.modal.setWidth(i.modal_params.success_width),i.modal.position(),i.loadPlugins()}})}else i.form.find("input[type=text], textarea").val(""),i.showModal(t,e)},successChanges:function(t,e,i){var n=this;t&&(n.type=t,n.showModalSuccess(e,i)),"add_like_project"===n.type?"catalog"===i.FROM_PAGE?n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT):"detail_page"===i.FROM_PAGE&&n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT):"remove_like_project"===n.type&&("catalog"===i.FROM_PAGE?n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT):"detail_page"===i.FROM_PAGE&&n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT)),n.form=null}},$(function(){new ajaxRequest}),$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},ajaxRequest.prototype={type:"",container:null,do_object:null,send_ajax_data:null,error_block:'<div class="error"><div class="errortext"></div></div>',init:function(){this.container=$("#page_container .page_wrapper"),this.startAction()},loadPlugins:function(){$(".styler").styler(),$("input.phone").mask("+7 (999) 999-99-99")},startAction:function(){var t=this;t.container.on("click",'[data-do_action="ajax_request"]',function(){t.do_object=$(this),t.type=$(this).data("do_type");var e=$(this).data("do_more_param");t.routeAction(e)})},routeAction:function(t){var e=this;"add_like_project"!==e.type&&"remove_like_project"!==e.type||"catalog"!==t?"add_like_project"!==e.type&&"remove_like_project"!==e.type||"detail_page"!==t||(e.send_ajax_data={id_project:e.do_object.closest(".catalog_element").data("id_project"),more_param:t}):e.send_ajax_data={id_project:e.do_object.closest(".product_item").data("id_project"),more_param:t},e.sendData()},sendData:function(){var t=this;$.ajax({url:"/ajax.php",type:"POST",dataType:"json",data:{type:t.type,data:t.send_ajax_data}}).done(function(e){e.errors||t.successChanges(e.SUCCESS_TYPE,e.SUCCESS_TITLE,e.MORE_PARAM),t.send_ajax_data=null})},successChanges:function(t,e,i){var n=this;t&&(n.type=t,n.showModalSuccess(e,i)),"add_like_project"===n.type?"catalog"===i.FROM_PAGE?(n.do_object.closest(".product_item").addClass("is_like"),n.do_object.data("do_type","remove_like_project"),n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT)):"detail_page"===i.FROM_PAGE&&(n.do_object.closest(".catalog_element").addClass("is_like"),n.do_object.data("do_type","remove_like_project"),n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT)):"remove_like_project"===n.type&&("catalog"===i.FROM_PAGE?(n.do_object.closest(".product_item").removeClass("is_like"),n.do_object.data("do_type","add_like_project"),n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT)):"detail_page"===i.FROM_PAGE&&(n.do_object.closest(".catalog_element").removeClass("is_like"),n.do_object.data("do_type","add_like_project"),n.container.find(".top_ilike .ilike_icon .counter").text(i.COUNT)))},showModalSuccess:function(t,e){var i=this;i.modal?i.modal.setTitle(t).ajax({url:"/ajax.php",data:{type:i.type},type:"POST",reload:!0,getData:"data-ajax",setContent:!0,spinner:!0,complete:function(){i.modal.setWidth(359),$(".modal_window").addClass("success").find(".jBox-closeButton").css("display","none"),i.loadPlugins()}}):i.showModal(t,e)},showModal:function(t,e){var i=this;i.afterCloseModal=function(){},t||(t="Информация");var n={},o={};i.type.indexOf("_success")+1||i.type,i.modal=new jBox("Modal",{width:320,addClass:"modal_window "+i.type,title:t,closeButton:"box",fixed:!0,blockScroll:!0,position:o,ajax:{url:"/ajax.php",data:{type:_type,data:n},type:"POST",reload:!0,getData:"data-ajax",setContent:!0,spinner:!0,complete:function(){i.loadPlugins()}},onCloseComplete:function(){i.afterCloseModal(),i.modal.destroy(),i.modal=null}}).open()}},$(document).ready(function(){$(".styler").styler({singleSelectzIndex:30}),$(".fancybox").fancybox({padding:0,beforeLoad:function(){this.title=$(this.element).data("title")},tpl:{closeBtn:'<div class="close_fancy_window"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 496.158 496.158" style="enable-background:new 0 0 496.158 496.158;" xml:space="preserve"><path d="M496.158,248.085c0-137.021-111.07-248.082-248.076-248.082C111.07,0.003,0,111.063,0,248.085 c0,137.002,111.07,248.07,248.082,248.07C385.088,496.155,496.158,385.087,496.158,248.085z"/><path d="M277.042,248.082l72.528-84.196c7.91-9.182,6.876-23.041-2.31-30.951 c-9.172-7.904-23.032-6.876-30.947,2.306l-68.236,79.212l-68.229-79.212c-7.91-9.188-21.771-10.216-30.954-2.306 c-9.186,7.91-10.214,21.77-2.304,30.951l72.522,84.196l-72.522,84.192c-7.91,9.182-6.882,23.041,2.304,30.951 c4.143,3.569,9.241,5.318,14.316,5.318c6.161,0,12.294-2.586,16.638-7.624l68.229-79.212l68.236,79.212 c4.338,5.041,10.47,7.624,16.637,7.624c5.069,0,10.168-1.749,14.311-5.318c9.186-7.91,10.22-21.77,2.31-30.951L277.042,248.082z"/></svg></div>',next:'<div class="next_fancy fancy_nav_btns"><svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 54 54" style="enable-background:new 0 0 54 54;" xml:space="preserve"><g><path d="M27,53L27,53C12.641,53,1,41.359,1,27v0C1,12.641,12.641,1,27,1h0c14.359,0,26,11.641,26,26v0 C53,41.359,41.359,53,27,53z"/><path d="M27,54C12.112,54,0,41.888,0,27S12.112,0,27,0s27,12.112,27,27S41.888,54,27,54z M27,2\tC13.215,2,2,13.215,2,27s11.215,25,25,25s25-11.215,25-25S40.785,2,27,2z"/><path d="M22.294,40c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414L32.88,27 L21.587,15.707c-0.391-0.391-0.391-1.023,0-1.414s1.023-0.391,1.414,0l11.498,11.498c0.667,0.667,0.667,1.751,0,2.418\tL23.001,39.707C22.806,39.902,22.55,40,22.294,40z"/></g></svg></div>',prev:'<div class="prev_fancy  fancy_nav_btns"><svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 54 54" style="enable-background:new 0 0 54 54;" xml:space="preserve"><g><path d="M27,1L27,1c14.359,0,26,11.641,26,26v0c0,14.359-11.641,26-26,26h0C12.641,53,1,41.359,1,27v0 C1,12.641,12.641,1,27,1z"/><path d="M27,54C12.112,54,0,41.888,0,27S12.112,0,27,0s27,12.112,27,27S41.888,54,27,54z M27,2 C13.215,2,2,13.215,2,27s11.215,25,25,25s25-11.215,25-25S40.785,2,27,2z"/><path d="M31.706,40c-0.256,0-0.512-0.098-0.707-0.293L19.501,28.209c-0.667-0.667-0.667-1.751,0-2.418 l11.498-11.498c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414L21.12,27l11.293,11.293c0.391,0.391,0.391,1.023,0,1.414 C32.218,39.902,31.962,40,31.706,40z"/></g></svg></div>'},helpers:{title:{type:"outside"},thumbs:{width:50,height:50},buttons:{}}}),$(".go_to_ancor").click(function(t){t.preventDefault();var e=$(this).attr("href");$("html,body").stop(!1,!1).animate({scrollTop:$(e).offset().top-70},700)}),$(".go_link").mousedown(function(t){if(""===$(this).data("go"))return!0;switch(t.which){case 1:case 2:return $(this).attr("href",$(this).data("go")),$(this).attr("data-go",""),$(this).click(),!1}}),$(".top_button").click(function(){$("html, body").animate({scrollTop:0},600,function(){$(".top_button").fadeOut(300)})}),$(window).scroll(function(){600<$(window).scrollTop()?$(".top_button").fadeIn(300):$(".top_button").fadeOut(300)})});